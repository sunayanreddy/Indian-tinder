(this["webpackJsonpindian-tinder-app-frontend"]=this["webpackJsonpindian-tinder-app-frontend"]||[]).push([[0],{57:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a.n(s),n=a(25),r=a.n(n),i=a(8),o=a(2),l=a(0);var d=e=>{let{onLogout:t}=e;const a=Object(o.g)();return Object(l.jsxs)("header",{className:"top-nav",children:[Object(l.jsx)("div",{className:"brand",children:"Indian Tinder Pro"}),Object(l.jsxs)("nav",{children:[Object(l.jsx)(i.b,{className:"/discover"===a.pathname?"active-link":"",to:"/discover",children:"Discover"}),Object(l.jsx)(i.b,{className:"/matches"===a.pathname?"active-link":"",to:"/matches",children:"Matches"})]}),Object(l.jsx)("button",{className:"btn btn-ghost",onClick:t,children:"Logout"})]})},j=a(10),b=a(27),h=a.n(b);const u=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5001/api";let m="";const O=h.a.create({baseURL:u,timeout:1e4});O.interceptors.request.use(e=>(m&&(e.headers=Object(j.a)(Object(j.a)({},e.headers),{},{Authorization:"Bearer ".concat(m)})),e));const p=async()=>(await O.get("/matches")).data,x=async e=>(await O.get("/messages",{params:{matchUserId:e}})).data,g=async(e,t)=>(await O.post("/typing",{toUserId:e,isTyping:t})).data,v={name:"",email:"",password:"",age:25,bio:"",location:"",interests:[]};var y=e=>{let{onAuthenticated:t}=e;const[a,c]=Object(s.useState)("login"),[n,r]=Object(s.useState)(""),[i,o]=Object(s.useState)(""),[d,b]=Object(s.useState)(""),[h,u]=Object(s.useState)(25),[m,p]=Object(s.useState)(""),[x,g]=Object(s.useState)(""),[y,f]=Object(s.useState)("travel, food, music"),[N,S]=Object(s.useState)(""),[w,k]=Object(s.useState)(!1),C=Object(s.useMemo)(()=>"Demo account: isha@example.com / password123",[]),E=async()=>{k(!0),S("");try{const e=await(async(e,t)=>(await O.post("/auth/login",{email:e,password:t})).data)(n,i);t(e.token,e.user)}catch(e){S(e instanceof Error?e.message:"Login failed")}finally{k(!1)}},I=async()=>{k(!0),S("");const e=Object(j.a)(Object(j.a)({},v),{},{name:d,email:n,password:i,age:h,bio:m,location:x,interests:y.split(",").map(e=>e.trim()).filter(Boolean)});try{const a=await(async e=>(await O.post("/auth/register",e)).data)(e);t(a.token,a.user)}catch(a){S(a instanceof Error?a.message:"Registration failed")}finally{k(!1)}};return Object(l.jsx)("main",{className:"auth-layout",children:Object(l.jsxs)("section",{className:"auth-panel",children:[Object(l.jsx)("h1",{children:"Indian Tinder Pro"}),Object(l.jsx)("p",{children:"Meet people, get matched, and start meaningful conversations."}),Object(l.jsxs)("div",{className:"auth-toggle",children:[Object(l.jsx)("button",{className:"btn ".concat("login"===a?"btn-like":"btn-ghost"),type:"button",onClick:()=>c("login"),children:"Login"}),Object(l.jsx)("button",{className:"btn ".concat("register"===a?"btn-like":"btn-ghost"),type:"button",onClick:()=>c("register"),children:"Register"})]}),Object(l.jsxs)("form",{className:"auth-form",onSubmit:async e=>{e.preventDefault(),"login"!==a?await I():await E()},children:["register"===a&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("input",{value:d,onChange:e=>b(e.target.value),type:"text",placeholder:"Full name",required:!0}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{value:h,onChange:e=>u(Number(e.target.value)),type:"number",min:18,max:70,placeholder:"Age",required:!0}),Object(l.jsx)("input",{value:x,onChange:e=>g(e.target.value),type:"text",placeholder:"City",required:!0})]}),Object(l.jsx)("input",{value:m,onChange:e=>p(e.target.value),type:"text",placeholder:"Bio",required:!0}),Object(l.jsx)("input",{value:y,onChange:e=>f(e.target.value),type:"text",placeholder:"Interests separated by commas",required:!0})]}),Object(l.jsx)("input",{value:n,onChange:e=>r(e.target.value),type:"email",placeholder:"Email",required:!0}),Object(l.jsx)("input",{value:i,onChange:e=>o(e.target.value),type:"password",placeholder:"Password",required:!0}),N&&Object(l.jsx)("p",{className:"error-text",children:N}),Object(l.jsx)("button",{className:"btn btn-like",type:"submit",disabled:w,children:w?"Please wait...":"login"===a?"Login":"Create Account"})]}),Object(l.jsx)("p",{className:"muted",children:C})]})})};var f=e=>{let{userId:t}=e;const a=Object(o.h)().matchUserId||"",[c,n]=Object(s.useState)([]),[r,d]=Object(s.useState)(null),[j,b]=Object(s.useState)(""),[h,v]=Object(s.useState)(!0),[y,f]=Object(s.useState)(""),[N,S]=Object(s.useState)(!1);Object(s.useEffect)(()=>{(async()=>{v(!0),f("");try{const[e,t]=await Promise.all([p(),x(a)]),s=e.find(e=>e.user.id===a)||null;s||f("Match not found."),d(s),n(t)}catch(e){f(e instanceof Error?e.message:"Unable to load chat")}finally{v(!1)}})()},[a]),Object(s.useEffect)(()=>{const e=(()=>{const e=encodeURIComponent(m);return new EventSource("".concat(u,"/events?token=").concat(e))})();return e.addEventListener("message",e=>{const s=(c=e.data,JSON.parse(c));var c;(s.fromUserId===t&&s.toUserId===a||s.fromUserId===a&&s.toUserId===t)&&n(e=>e.some(e=>e.id===s.id)?e:[...e,s])}),e.addEventListener("typing",e=>{const t=(s=e.data,JSON.parse(s));var s;t.fromUserId===a&&S(Boolean(t.isTyping))}),e.addEventListener("match",e=>{var t;const s=(c=e.data,JSON.parse(c));var c;(null===s||void 0===s||null===(t=s.user)||void 0===t?void 0:t.id)===a&&d(s)}),e.onerror=()=>{e.close()},()=>{e.close()}},[a,t]),Object(s.useEffect)(()=>{const e=setTimeout(()=>{g(a,j.trim().length>0)},200);return()=>clearTimeout(e)},[j,a]);const w=async()=>{if(j.trim())try{await(async(e,t)=>(await O.post("/messages",{toUserId:e,text:t})).data)(a,j),b(""),g(a,!1)}catch(e){f(e instanceof Error?e.message:"Failed to send message")}},k=Object(s.useMemo)(()=>[...c].sort((e,t)=>e.createdAt.localeCompare(t.createdAt)),[c]);return Object(l.jsxs)("div",{className:"page-shell chat-shell",children:[Object(l.jsxs)("div",{className:"page-head",children:[Object(l.jsx)("h1",{children:r?"Chat with ".concat(r.user.name):"Chat"}),Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/matches",children:"Back"})]}),h&&Object(l.jsx)("p",{children:"Loading conversation..."}),y&&Object(l.jsx)("p",{className:"error-text",children:y}),Object(l.jsx)("div",{className:"chat-thread",children:k.map(e=>Object(l.jsxs)("div",{className:"message-bubble ".concat(e.fromUserId===t?"mine":"theirs"),children:[Object(l.jsx)("p",{children:e.text}),Object(l.jsx)("span",{children:new Date(e.createdAt).toLocaleTimeString()})]},e.id))}),N&&Object(l.jsxs)("p",{className:"typing-indicator",children:[(null===r||void 0===r?void 0:r.user.name)||"They"," is typing..."]}),Object(l.jsxs)("div",{className:"chat-input-row",children:[Object(l.jsx)("input",{value:j,onChange:e=>b(e.target.value),placeholder:"Write your message...",onKeyDown:e=>{"Enter"===e.key&&w()}}),Object(l.jsx)("button",{className:"btn btn-like",onClick:()=>{w()},children:"Send"})]})]})};var N=e=>{let{match:t,onClose:a}=e;return Object(l.jsx)("div",{className:"overlay",role:"dialog","aria-modal":"true",children:Object(l.jsxs)("div",{className:"modal",children:[Object(l.jsx)("h2",{children:"It's a Match"}),Object(l.jsx)("img",{src:t.user.avatarUrl,alt:t.user.name,className:"match-avatar"}),Object(l.jsxs)("p",{children:["You and ",Object(l.jsx)("strong",{children:t.user.name})," liked each other."]}),Object(l.jsx)("button",{className:"btn btn-like",onClick:a,children:"Continue"})]})})};var S=e=>{let{user:t,onLike:a,onPass:s}=e;return Object(l.jsxs)("article",{className:"profile-card",children:[Object(l.jsx)("img",{src:t.avatarUrl,alt:t.name,className:"profile-image"}),Object(l.jsxs)("div",{className:"profile-body",children:[Object(l.jsxs)("h2",{children:[t.name,", ",t.age]}),Object(l.jsx)("p",{className:"profile-location",children:t.location}),Object(l.jsx)("p",{children:t.bio}),Object(l.jsx)("div",{className:"tag-row",children:t.interests.map(e=>Object(l.jsx)("span",{className:"tag",children:e},e))}),Object(l.jsxs)("div",{className:"action-row",children:[Object(l.jsx)("button",{className:"btn btn-pass",onClick:s,children:"Pass"}),Object(l.jsx)("button",{className:"btn btn-like",onClick:a,children:"Like"})]})]})]})};var w=()=>{const[e,t]=Object(s.useState)([]),[a,c]=Object(s.useState)(!0),[n,r]=Object(s.useState)(""),[i,o]=Object(s.useState)(null),d=async()=>{c(!0),r("");try{const e=await(async()=>(await O.get("/users/discover")).data)();t(e)}catch(e){r(e instanceof Error?e.message:"Failed to load profiles")}finally{c(!1)}};Object(s.useEffect)(()=>{d()},[]);const j=async(e,a)=>{try{const s=await(async(e,t)=>(await O.post("/swipes",{targetUserId:e,action:t})).data)(e,a);t(t=>t.filter(t=>t.id!==e)),s.matched&&s.match&&o(s.match)}catch(s){r(s instanceof Error?s.message:"Swipe failed")}},b=e[0];return Object(l.jsxs)("div",{className:"page-shell",children:[Object(l.jsx)("h1",{children:"Discover"}),a&&Object(l.jsx)("p",{children:"Loading profiles..."}),n&&Object(l.jsx)("p",{className:"error-text",children:n}),!a&&!b&&Object(l.jsx)("p",{children:"No new profiles right now. Check back soon."}),b&&Object(l.jsx)(S,{user:b,onPass:()=>j(b.id,"pass"),onLike:()=>j(b.id,"like")}),i&&Object(l.jsx)(N,{match:i,onClose:()=>o(null)})]})};var k=()=>{const[e,t]=Object(s.useState)([]),[a,c]=Object(s.useState)(!0),[n,r]=Object(s.useState)(""),o=async()=>{c(!0),r("");try{const e=await p();t(e)}catch(e){r(e instanceof Error?e.message:"Failed to load matches")}finally{c(!1)}};return Object(s.useEffect)(()=>{o()},[]),Object(l.jsxs)("div",{className:"page-shell",children:[Object(l.jsxs)("div",{className:"page-head",children:[Object(l.jsx)("h1",{children:"Connections"}),Object(l.jsx)("button",{className:"btn btn-ghost",onClick:()=>{o()},children:"Refresh"})]}),a&&Object(l.jsx)("p",{children:"Loading your connections..."}),n&&Object(l.jsx)("p",{className:"error-text",children:n}),!a&&0===e.length&&Object(l.jsx)("p",{children:"You have no matches yet. Start swiping."}),Object(l.jsx)("div",{className:"match-list",children:e.map(e=>{var t;return Object(l.jsxs)(i.b,{className:"match-item",to:"/chat/".concat(e.user.id),children:[Object(l.jsx)("img",{src:e.user.avatarUrl,alt:e.user.name}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:e.user.name}),Object(l.jsx)("p",{children:(null===(t=e.lastMessage)||void 0===t?void 0:t.text)||"You are now connected. Say hi."})]})]},e.matchId)})})]})};a(57);var C=()=>{const[e,t]=Object(s.useState)(()=>localStorage.getItem("dating_token")||""),[a,c]=Object(s.useState)(null),[n,r]=Object(s.useState)(Boolean(e));Object(s.useEffect)(()=>{(e=>{m=e})(e||"")},[e]),Object(s.useEffect)(()=>{(async()=>{if(!e)return c(null),void r(!1);try{const e=await(async()=>(await O.get("/users/me")).data)();c(e)}catch(a){localStorage.removeItem("dating_token"),t(""),c(null)}finally{r(!1)}})()},[e]);const j=Object(s.useMemo)(()=>Boolean(e&&a),[e,a]),b=e=>{e?localStorage.setItem("dating_token",e):localStorage.removeItem("dating_token"),t(e)};return n?Object(l.jsx)("div",{className:"loading-shell",children:"Loading your profile..."}):Object(l.jsxs)(i.a,{children:[j&&Object(l.jsx)(d,{onLogout:()=>{b(""),c(null)}}),Object(l.jsxs)(o.d,{children:[Object(l.jsx)(o.b,{path:"/auth",children:j?Object(l.jsx)(o.a,{to:"/discover"}):Object(l.jsx)(y,{onAuthenticated:(e,t)=>{b(e),c(t)}})}),Object(l.jsx)(o.b,{path:"/discover",children:j?Object(l.jsx)(w,{}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/matches",children:j?Object(l.jsx)(k,{}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/chat/:matchUserId",children:j&&a?Object(l.jsx)(f,{userId:a.id}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/",children:Object(l.jsx)(o.a,{to:j?"/discover":"/auth"})})]})]})};r.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(C,{})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.bfef08b5.chunk.js.map