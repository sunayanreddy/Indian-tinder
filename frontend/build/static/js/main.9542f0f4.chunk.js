(this["webpackJsonpindian-tinder-app-frontend"]=this["webpackJsonpindian-tinder-app-frontend"]||[]).push([[0],{57:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),c=a(25),r=a.n(c),i=a(3),o=a(2),l=a(0);var j=e=>{let{compact:t=!1}=e;return Object(l.jsxs)("div",{className:"brand-logo ".concat(t?"compact":""),children:[Object(l.jsx)("span",{className:"brand-mark","aria-hidden":"true",children:"IT"}),Object(l.jsx)("span",{className:"brand-wordmark",children:"Indian Tinder"})]})};var d=e=>{let{onLogout:t}=e;const a=Object(o.g)();return Object(l.jsxs)("header",{className:"top-nav",children:[Object(l.jsx)("div",{className:"brand",children:Object(l.jsx)(j,{compact:!0})}),Object(l.jsxs)("nav",{children:[Object(l.jsx)(i.b,{className:"/discover"===a.pathname?"active-link":"",to:"/discover",children:"Discover"}),Object(l.jsx)(i.b,{className:"/matches"===a.pathname?"active-link":"",to:"/matches",children:"Matches"}),Object(l.jsx)(i.b,{className:"/profile"===a.pathname?"active-link":"",to:"/profile",children:"Profile"})]}),Object(l.jsx)("button",{className:"btn btn-ghost",onClick:t,children:"Logout"})]})},u=a(10),h=a(27),b=a.n(h);const p=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5001/api";let m="";const O=b.a.create({baseURL:p,timeout:3e4});O.interceptors.request.use(e=>(m&&(e.headers=Object(u.a)(Object(u.a)({},e.headers),{},{Authorization:"Bearer ".concat(m)})),e));O.interceptors.response.use(e=>e,e=>{const t=new Error(((e,t)=>{var a,s;const n=null===e||void 0===e||null===(a=e.response)||void 0===a?void 0:a.data,c=n&&"string"===typeof n.message&&n.message||n&&"string"===typeof n.error&&n.error||("string"===typeof n?n:"");return"string"===typeof c&&c.trim()?c:"Network Error"===(null===e||void 0===e?void 0:e.message)?"Unable to reach server. Please check your connection and try again.":400===(null===e||void 0===e||null===(s=e.response)||void 0===s?void 0:s.status)?"Invalid input. Please check your details and try again.":t})(e,"Request failed"));return Object.defineProperty(t,"status",{value:e&&e.response?e.response.status:0,enumerable:!1,configurable:!0}),Promise.reject(t)});const g=async()=>(await O.get("/users/me")).data,v=async e=>(await O.put("/users/me/profile",e)).data,x=async()=>(await O.get("/matches")).data,y=async e=>(await O.get("/messages",{params:{matchUserId:e}})).data,f=async(e,t)=>(await O.post("/typing",{toUserId:e,isTyping:t})).data,N=(e,t)=>null!==e&&void 0!==e&&e.message&&"string"===typeof e.message?e.message:t,S=e=>Number((null===e||void 0===e?void 0:e.status)||0),w={name:"",email:"",password:""};var k=e=>{let{onAuthenticated:t}=e;const a=()=>"register"===new URLSearchParams(window.location.search).get("mode")?"register":"login",[n,c]=Object(s.useState)(a),[r,i]=Object(s.useState)(""),[o,d]=Object(s.useState)(""),[h,b]=Object(s.useState)(""),[p,m]=Object(s.useState)(""),[g,v]=Object(s.useState)(!1),x=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GOOGLE_CLIENT_ID||"";Object(s.useEffect)(()=>{c(a())},[]),Object(s.useEffect)(()=>{if(!x)return;const e="google-identity-script";if(!document.getElementById(e)){const a=document.createElement("script");a.src="https://accounts.google.com/gsi/client",a.async=!0,a.defer=!0,a.id=e,a.onload=()=>{const e=window.google;if(e){e.accounts.id.initialize({client_id:x,callback:async e=>{try{const a=await(async e=>(await O.post("/auth/google",{idToken:e})).data)(e.credential);t(a.token,a.user)}catch(a){m(N(a,"Google login failed"))}}});const a=document.getElementById("google-signin-button");a&&(a.innerHTML="",e.accounts.id.renderButton(a,{theme:"outline",size:"large",shape:"pill",text:"continue_with"}))}},document.body.appendChild(a)}},[x,t]);const y=async()=>{v(!0),m("");try{const e=await(async(e,t)=>(await O.post("/auth/login",{email:e,password:t})).data)(r,o);t(e.token,e.user)}catch(e){m(N(e,"Login failed"))}finally{v(!1)}},f=async()=>{v(!0),m("");const e=Object(u.a)(Object(u.a)({},w),{},{name:h,email:r,password:o});try{const a=await(async e=>(await O.post("/auth/register",e)).data)(e);t(a.token,a.user)}catch(a){m(N(a,"Registration failed"))}finally{v(!1)}};return Object(l.jsx)("main",{className:"auth-layout",children:Object(l.jsxs)("section",{className:"auth-shell",children:[Object(l.jsxs)("aside",{className:"auth-side",children:[Object(l.jsx)(j,{}),Object(l.jsx)("h2",{children:"Secure dating built on trust, not pressure"}),Object(l.jsx)("p",{children:"Start with private profiles, match with people who share your intent, and choose when to unlock photos."}),Object(l.jsxs)("ul",{className:"auth-benefits",children:[Object(l.jsx)("li",{children:"Google and email sign-in"}),Object(l.jsx)("li",{children:"Intent and compatibility-first profile flow"}),Object(l.jsx)("li",{children:"Photo access only by explicit consent"})]})]}),Object(l.jsxs)("div",{className:"auth-panel",children:[Object(l.jsx)("h1",{children:"login"===n?"Welcome Back":"Create Your Account"}),Object(l.jsx)("p",{children:"Use Gmail/Google or email login. Private photos unlock only with consent after meaningful chat."}),Object(l.jsxs)("div",{className:"auth-toggle",children:[Object(l.jsx)("button",{className:"btn ".concat("login"===n?"btn-like":"btn-ghost"),type:"button",onClick:()=>c("login"),children:"Login"}),Object(l.jsx)("button",{className:"btn ".concat("register"===n?"btn-like":"btn-ghost"),type:"button",onClick:()=>c("register"),children:"Register"})]}),Object(l.jsxs)("form",{className:"auth-form",onSubmit:async e=>{e.preventDefault(),"login"!==n?await f():await y()},children:["register"===n&&Object(l.jsx)("input",{value:h,onChange:e=>b(e.target.value),type:"text",placeholder:"Full name",required:!0}),Object(l.jsx)("input",{value:r,onChange:e=>i(e.target.value),type:"email",placeholder:"Email",required:!0}),Object(l.jsx)("input",{value:o,onChange:e=>d(e.target.value),type:"password",placeholder:"Password",required:!0}),p&&Object(l.jsx)("p",{className:"error-text",children:p}),Object(l.jsx)("button",{className:"btn btn-like",type:"submit",disabled:g,children:g?"Please wait...":"login"===n?"Login":"Create Account"})]}),x?Object(l.jsxs)("div",{className:"google-wrap",children:[Object(l.jsx)("p",{className:"muted",children:"or continue with Google"}),Object(l.jsx)("div",{id:"google-signin-button"})]}):null]})]})})};const _={fox:{emoji:"\ud83e\udd8a",bg:"#fee2e2"},lotus:{emoji:"\ud83e\udeb7",bg:"#fce7f3"},lion:{emoji:"\ud83e\udd81",bg:"#fde68a"},falcon:{emoji:"\ud83e\udd85",bg:"#dbeafe"},panda:{emoji:"\ud83d\udc3c",bg:"#e5e7eb"},tiger:{emoji:"\ud83d\udc2f",bg:"#ffedd5"},peacock:{emoji:"\ud83e\udd9a",bg:"#dcfce7"}};var C=e=>{let{avatarKey:t,name:a,size:s=56}=e;const n=_[t]||_.fox;return Object(l.jsx)("div",{className:"avatar-badge",title:"".concat(a,"'s avatar"),style:{width:s,height:s,background:n.bg},children:Object(l.jsx)("span",{style:{fontSize:Math.floor(.45*s)},children:n.emoji})})};var P=e=>{let{userId:t}=e;const a=Object(o.h)().matchUserId||"",[n,c]=Object(s.useState)([]),[r,j]=Object(s.useState)(null),[d,u]=Object(s.useState)(""),[h,b]=Object(s.useState)(!0),[g,v]=Object(s.useState)(""),[N,S]=Object(s.useState)(!1),[w,k]=Object(s.useState)([]),[_,P]=Object(s.useState)(""),E=async()=>{b(!0),v("");try{const[t,s]=await Promise.all([x(),y(a)]),n=t.find(e=>e.user.id===a)||null;if(n||v("Match not found."),j(n),c(s),null!==n&&void 0!==n&&n.canViewPrivatePhotos)try{const e=await(async e=>(await O.get("/matches/".concat(e,"/private-photos"))).data.photos)(a);k(e),P("")}catch(e){P(e instanceof Error?e.message:"Could not load private photos")}else k([])}catch(e){v(e instanceof Error?e.message:"Unable to load chat")}finally{b(!1)}};Object(s.useEffect)(()=>{E()},[a]),Object(s.useEffect)(()=>{const e=(()=>{const e=encodeURIComponent(m);return new EventSource("".concat(p,"/events?token=").concat(e))})();return e.addEventListener("message",e=>{const s=(n=e.data,JSON.parse(n));var n;(s.fromUserId===t&&s.toUserId===a||s.fromUserId===a&&s.toUserId===t)&&c(e=>e.some(e=>e.id===s.id)?e:[...e,s])}),e.addEventListener("typing",e=>{const t=(s=e.data,JSON.parse(s));var s;t.fromUserId===a&&S(Boolean(t.isTyping))}),e.addEventListener("match",e=>{var t;const s=(n=e.data,JSON.parse(n));var n;(null===s||void 0===s||null===(t=s.user)||void 0===t?void 0:t.id)===a&&j(s)}),e.onerror=()=>{e.close()},()=>{e.close()}},[a,t]),Object(s.useEffect)(()=>{const e=setTimeout(()=>{f(a,d.trim().length>0)},250);return()=>clearTimeout(e)},[d,a]);const L=async()=>{if(d.trim())try{await(async(e,t)=>(await O.post("/messages",{toUserId:e,text:t})).data)(a,d),u(""),f(a,!1),E()}catch(e){v(e instanceof Error?e.message:"Failed to send message")}},I=async()=>{try{await(async e=>(await O.post("/matches/".concat(e,"/grant-photo-access"))).data)(a),await E()}catch(e){P(e instanceof Error?e.message:"Unable to grant photo access")}},T=Object(s.useMemo)(()=>[...n].sort((e,t)=>e.createdAt.localeCompare(t.createdAt)),[n]);return Object(l.jsxs)("div",{className:"page-shell chat-shell",children:[Object(l.jsxs)("div",{className:"page-head",children:[Object(l.jsx)("h1",{children:r?"Chat with ".concat(r.user.name):"Chat"}),Object(l.jsxs)("div",{className:"match-actions",children:[Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/profile/".concat(a),children:"View Profile"}),Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/matches",children:"Back"})]})]}),r&&Object(l.jsxs)("div",{className:"trust-panel",children:[Object(l.jsx)(C,{avatarKey:r.user.avatarKey,name:r.user.name,size:64}),Object(l.jsxs)("div",{children:[Object(l.jsxs)("p",{className:"muted",children:["Trust progress: ",r.messageCount,"/8 messages"]}),!r.canViewPrivatePhotos&&Object(l.jsx)("p",{className:"muted",children:"Private photos unlock only after enough chat and explicit permission."}),r.isEligibleToGrantPhotoAccess&&!r.hasGrantedPhotoAccess&&Object(l.jsx)("button",{className:"btn btn-ghost",onClick:()=>{I()},children:"Grant Your Photo Access"})]})]}),Object(l.jsx)("div",{className:"chat-expiry-notice",children:"Chats auto-delete after 24 hours to protect your privacy."}),h&&Object(l.jsx)("p",{children:"Loading conversation..."}),g&&Object(l.jsx)("p",{className:"error-text",children:g}),Object(l.jsx)("div",{className:"chat-thread",children:T.map(e=>Object(l.jsxs)("div",{className:"message-bubble ".concat(e.fromUserId===t?"mine":"theirs"),children:[Object(l.jsx)("p",{children:e.text}),Object(l.jsx)("span",{children:new Date(e.createdAt).toLocaleTimeString()})]},e.id))}),N&&Object(l.jsxs)("p",{className:"typing-indicator",children:[(null===r||void 0===r?void 0:r.user.name)||"They"," is typing..."]}),(null===r||void 0===r?void 0:r.canViewPrivatePhotos)&&Object(l.jsx)("div",{className:"private-photo-grid",children:w.map(e=>Object(l.jsx)("img",{src:e,alt:"Private profile",className:"private-photo"},e))}),_&&Object(l.jsx)("p",{className:"error-text",children:_}),Object(l.jsxs)("div",{className:"chat-input-row",children:[Object(l.jsx)("input",{value:d,onChange:e=>u(e.target.value),placeholder:"Write your message...",onKeyDown:e=>{"Enter"===e.key&&L()}}),Object(l.jsx)("button",{className:"btn btn-like",onClick:()=>{L()},children:"Send"})]})]})};var E=e=>{let{match:t,onClose:a}=e;return Object(l.jsx)("div",{className:"overlay",role:"dialog","aria-modal":"true",children:Object(l.jsxs)("div",{className:"modal",children:[Object(l.jsx)("h2",{children:"It's a Match"}),Object(l.jsx)(C,{avatarKey:t.user.avatarKey,name:t.user.name,size:120}),Object(l.jsxs)("p",{children:["You and ",Object(l.jsx)("strong",{children:t.user.name})," liked each other."]}),Object(l.jsx)("p",{className:"muted",children:"Keep chatting to build trust and unlock private photos with consent."}),Object(l.jsx)("button",{className:"btn btn-like",onClick:a,children:"Continue"})]})})};var L=e=>{let{user:t,onLike:a,onPass:s}=e;return Object(l.jsxs)("article",{className:"profile-card",children:[Object(l.jsxs)("div",{className:"avatar-panel",children:[Object(l.jsx)(C,{avatarKey:t.avatarKey,name:t.name,size:160}),Object(l.jsx)("p",{className:"muted",children:"Private photos stay hidden until both trust each other."})]}),Object(l.jsxs)("div",{className:"profile-body",children:[Object(l.jsxs)("h2",{children:[t.name,", ",t.age]}),Object(l.jsxs)("p",{className:"profile-location",children:[t.location," \xb7 ",t.gender.replace("_"," ")]}),Object(l.jsx)("p",{children:t.bio||"No bio yet."}),Object(l.jsxs)("p",{className:"muted",children:[t.occupation," \xb7 ",t.education]}),Object(l.jsxs)("p",{className:"muted",children:["Looking for ",t.lookingFor.replace("_"," ")," \xb7 Goal: ",t.relationshipGoal.replace("_"," ")]}),Object(l.jsx)("div",{className:"tag-row",children:t.interests.map(e=>Object(l.jsx)("span",{className:"tag",children:e},e))}),Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/profile/".concat(t.id),children:"View Profile"}),Object(l.jsxs)("div",{className:"action-row",children:[Object(l.jsx)("button",{className:"btn btn-pass",onClick:s,children:"Pass"}),Object(l.jsx)("button",{className:"btn btn-like",onClick:a,children:"Like"})]})]})]})};var I=()=>{const[e,t]=Object(s.useState)([]),[a,n]=Object(s.useState)(!0),[c,r]=Object(s.useState)(""),[i,o]=Object(s.useState)(null),j=async()=>{n(!0),r("");try{const e=await(async()=>(await O.get("/users/discover")).data)();t(e)}catch(e){r(e instanceof Error?e.message:"Failed to load profiles")}finally{n(!1)}};Object(s.useEffect)(()=>{j()},[]);const d=async(e,a)=>{try{const s=await(async(e,t)=>(await O.post("/swipes",{targetUserId:e,action:t})).data)(e,a);t(t=>t.filter(t=>t.id!==e)),s.matched&&s.match&&o(s.match)}catch(s){r(s instanceof Error?s.message:"Swipe failed")}},u=e[0];return Object(l.jsxs)("div",{className:"page-shell",children:[Object(l.jsx)("h1",{children:"Discover"}),a&&Object(l.jsx)("p",{children:"Loading profiles..."}),c&&Object(l.jsx)("p",{className:"error-text",children:c}),!a&&!u&&Object(l.jsx)("p",{children:"No new profiles right now. Check back soon."}),u&&Object(l.jsx)(L,{user:u,onPass:()=>d(u.id,"pass"),onLike:()=>d(u.id,"like")}),i&&Object(l.jsx)(E,{match:i,onClose:()=>o(null)})]})};var T=()=>Object(l.jsxs)("main",{className:"landing-page",children:[Object(l.jsxs)("header",{className:"landing-header",children:[Object(l.jsx)("div",{className:"landing-brand",children:Object(l.jsx)(j,{})}),Object(l.jsxs)("nav",{className:"landing-actions",children:[Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/auth?mode=login",children:"Login"}),Object(l.jsx)(i.b,{className:"btn btn-like",to:"/auth?mode=register",children:"Sign Up"})]})]}),Object(l.jsxs)("section",{className:"landing-hero",children:[Object(l.jsxs)("div",{className:"landing-copy",children:[Object(l.jsx)("p",{className:"landing-kicker",children:"Date Blind, Build trust and become friends."}),Object(l.jsx)("h1",{children:"Date Blind, Build trust and become friends."}),Object(l.jsx)("p",{children:"Match through personality-first profiles and avatars. Unlock photos only after both people connect, chat, and consent."}),Object(l.jsxs)("div",{className:"landing-cta-row",children:[Object(l.jsx)(i.b,{className:"btn btn-like",to:"/auth?mode=register",children:"Start Dating"}),Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/auth?mode=login",children:"I Have an Account"})]}),Object(l.jsxs)("div",{className:"landing-stats",children:[Object(l.jsxs)("div",{className:"stat-card",children:[Object(l.jsx)("h3",{children:"Consent-first"}),Object(l.jsx)("p",{children:"Private images remain locked until both users grant access."})]}),Object(l.jsxs)("div",{className:"stat-card",children:[Object(l.jsx)("h3",{children:"Avatar-led Discovery"}),Object(l.jsx)("p",{children:"Match through values and vibe before appearance."})]})]})]}),Object(l.jsx)("div",{className:"landing-visual",style:{backgroundImage:"linear-gradient(190deg, rgba(9, 14, 22, 0.12), rgba(9, 14, 22, 0.28)), url('/landing-couple.png')"},role:"img","aria-label":"Blind date visual"})]}),Object(l.jsxs)("section",{className:"feature-grid",children:[Object(l.jsxs)("article",{className:"feature-card",children:[Object(l.jsx)("h3",{children:"Intent-led Profiles"}),Object(l.jsx)("p",{children:"Set your relationship goals, preferences, lifestyle, and key details so every connection starts with clarity."})]}),Object(l.jsxs)("article",{className:"feature-card",children:[Object(l.jsx)("h3",{children:"Smart Match Journey"}),Object(l.jsx)("p",{children:"Discover profiles, match instantly on mutual likes, and move into focused one-to-one conversation."})]}),Object(l.jsxs)("article",{className:"feature-card",children:[Object(l.jsx)("h3",{children:"Trust Unlock Layer"}),Object(l.jsx)("p",{children:"Photos are shared only after meaningful conversation and explicit permission from the profile owner."})]})]})]});var U=()=>{const[e,t]=Object(s.useState)([]),[a,n]=Object(s.useState)(!0),[c,r]=Object(s.useState)(""),o=async()=>{n(!0),r("");try{const e=await x();t(e)}catch(e){r(e instanceof Error?e.message:"Failed to load matches")}finally{n(!1)}};return Object(s.useEffect)(()=>{o()},[]),Object(l.jsxs)("div",{className:"page-shell",children:[Object(l.jsxs)("div",{className:"page-head",children:[Object(l.jsx)("h1",{children:"Connections"}),Object(l.jsx)("button",{className:"btn btn-ghost",onClick:()=>{o()},children:"Refresh"})]}),a&&Object(l.jsx)("p",{children:"Loading your connections..."}),c&&Object(l.jsx)("p",{className:"error-text",children:c}),!a&&0===e.length&&Object(l.jsx)("p",{children:"You have no matches yet. Start swiping."}),Object(l.jsx)("div",{className:"match-list",children:e.map(e=>{var t;return Object(l.jsxs)("div",{className:"match-item",children:[Object(l.jsx)(C,{avatarKey:e.user.avatarKey,name:e.user.name,size:56}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:e.user.name}),Object(l.jsx)("p",{children:(null===(t=e.lastMessage)||void 0===t?void 0:t.text)||"You are now connected. Say hi."}),Object(l.jsxs)("small",{className:"muted",children:["Messages: ",e.messageCount]}),Object(l.jsxs)("div",{className:"match-actions",children:[Object(l.jsx)(i.b,{className:"btn btn-ghost",to:"/profile/".concat(e.user.id),children:"View Profile"}),Object(l.jsx)(i.b,{className:"btn btn-like",to:"/chat/".concat(e.user.id),children:"Open Chat"})]})]})]},e.matchId)})})]})};const D=e=>{switch(e){case"man":return"man";case"woman":return"woman";case"non_binary":return"non_binary";case"other":return"other";default:return"prefer_not_say"}},R=e=>{switch(e){case"never":case"occasionally":case"socially":case"regularly":return e;default:return"prefer_not_say"}};var q=e=>{let{onUserUpdated:t}=e;const[a,n]=Object(s.useState)(null),[c,r]=Object(s.useState)(!0),[i,o]=Object(s.useState)(!1),[j,d]=Object(s.useState)(""),[u,h]=Object(s.useState)(""),[b,p]=Object(s.useState)(21),[m,g]=Object(s.useState)("prefer_not_say"),[x,y]=Object(s.useState)(""),[f,S]=Object(s.useState)(""),[w,k]=Object(s.useState)(""),[_,P]=Object(s.useState)("fox"),[E,L]=Object(s.useState)("prefer_not_say"),[I,T]=Object(s.useState)("long_term"),[U,q]=Object(s.useState)(""),[B,K]=Object(s.useState)(""),[A,F]=Object(s.useState)(170),[M,G]=Object(s.useState)("prefer_not_say"),[W,z]=Object(s.useState)("prefer_not_say"),[H,V]=Object(s.useState)(""),[J,Y]=Object(s.useState)(""),[Q,X]=Object(s.useState)(""),Z=async()=>{r(!0),d("");try{const e=await(async()=>(await O.get("/users/me/details")).data)();n(e),h(e.user.name||""),p(e.user.age||21),g(e.user.gender||"prefer_not_say"),y(e.user.bio||""),S(e.user.location||""),k((e.user.interests||[]).join(", ")),P(e.user.avatarKey||"fox"),L(e.user.lookingFor||"prefer_not_say"),T(e.user.relationshipGoal||"long_term"),q(e.user.occupation||""),K(e.user.education||""),F(e.user.heightCm||170),G(e.user.drinking||"prefer_not_say"),z(e.user.smoking||"prefer_not_say"),V(e.user.religion||""),Y((e.user.languages||[]).join(", ")),X((e.privatePhotos||[]).join("\n"))}catch(e){d(N(e,"Could not load profile"))}finally{r(!1)}};Object(s.useEffect)(()=>{Z()},[]);return c?Object(l.jsx)("div",{className:"page-shell",children:Object(l.jsx)("p",{children:"Loading your profile..."})}):Object(l.jsxs)("div",{className:"page-shell",children:[Object(l.jsx)("div",{className:"page-head",children:Object(l.jsx)("h1",{children:"My Profile"})}),a&&Object(l.jsxs)("div",{className:"trust-panel",children:[Object(l.jsx)(C,{avatarKey:_,name:u,size:72}),Object(l.jsxs)("div",{children:[Object(l.jsx)("p",{className:"muted",children:a.email}),Object(l.jsx)("p",{className:"muted",children:"Edit your details and private photos anytime."})]})]}),Object(l.jsxs)("form",{className:"auth-form",onSubmit:async e=>{e.preventDefault(),o(!0),d("");try{const e=w.split(",").map(e=>e.trim()).filter(Boolean),a=J.split(",").map(e=>e.trim()).filter(Boolean),s=await v({name:u,age:b,gender:D(m),bio:x,location:f,interests:e,avatarKey:_,lookingFor:E,relationshipGoal:I,occupation:U,education:B,heightCm:A,drinking:M,smoking:W,religion:H,languages:a,privatePhotos:Q.split("\n").map(e=>e.trim()).filter(Boolean)});t(s),window.location.assign("/discover")}catch(a){d(N(a,"Could not save profile"))}finally{o(!1)}},children:[Object(l.jsx)("input",{value:u,onChange:e=>h(e.target.value),placeholder:"Name",required:!0}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{type:"number",min:18,max:80,value:b,onChange:e=>p(Number(e.target.value)),required:!0}),Object(l.jsxs)("select",{value:m,onChange:e=>g(e.target.value),children:[Object(l.jsx)("option",{value:"man",children:"Man"}),Object(l.jsx)("option",{value:"woman",children:"Woman"}),Object(l.jsx)("option",{value:"non_binary",children:"Non-binary"}),Object(l.jsx)("option",{value:"other",children:"Other"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Prefer not to say"})]})]}),Object(l.jsx)("input",{value:f,onChange:e=>S(e.target.value),placeholder:"Location",required:!0}),Object(l.jsx)("textarea",{value:x,onChange:e=>y(e.target.value),rows:3,placeholder:"Bio",required:!0}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsxs)("select",{value:E,onChange:e=>L((e=>{switch(e){case"man":case"woman":case"non_binary":case"everyone":return e;default:return"prefer_not_say"}})(e.target.value)),children:[Object(l.jsx)("option",{value:"man",children:"Looking for Men"}),Object(l.jsx)("option",{value:"woman",children:"Looking for Women"}),Object(l.jsx)("option",{value:"non_binary",children:"Looking for Non-binary"}),Object(l.jsx)("option",{value:"everyone",children:"Looking for Everyone"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Prefer not to say"})]}),Object(l.jsxs)("select",{value:I,onChange:e=>T((e=>{switch(e){case"short_term":case"marriage":case"friendship":return e;default:return"long_term"}})(e.target.value)),children:[Object(l.jsx)("option",{value:"long_term",children:"Long-term relationship"}),Object(l.jsx)("option",{value:"short_term",children:"Short-term dating"}),Object(l.jsx)("option",{value:"marriage",children:"Marriage"}),Object(l.jsx)("option",{value:"friendship",children:"Friendship first"})]})]}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{value:U,onChange:e=>q(e.target.value),placeholder:"Occupation",required:!0}),Object(l.jsx)("input",{value:B,onChange:e=>K(e.target.value),placeholder:"Education",required:!0})]}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{type:"number",min:120,max:230,value:A,onChange:e=>F(Number(e.target.value)),placeholder:"Height (cm)",required:!0}),Object(l.jsx)("input",{value:H,onChange:e=>V(e.target.value),placeholder:"Religion",required:!0})]}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsxs)("select",{value:M,onChange:e=>G(R(e.target.value)),children:[Object(l.jsx)("option",{value:"never",children:"Drinking: Never"}),Object(l.jsx)("option",{value:"occasionally",children:"Drinking: Occasionally"}),Object(l.jsx)("option",{value:"socially",children:"Drinking: Socially"}),Object(l.jsx)("option",{value:"regularly",children:"Drinking: Regularly"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Drinking: Prefer not to say"})]}),Object(l.jsxs)("select",{value:W,onChange:e=>z(R(e.target.value)),children:[Object(l.jsx)("option",{value:"never",children:"Smoking: Never"}),Object(l.jsx)("option",{value:"occasionally",children:"Smoking: Occasionally"}),Object(l.jsx)("option",{value:"socially",children:"Smoking: Socially"}),Object(l.jsx)("option",{value:"regularly",children:"Smoking: Regularly"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Smoking: Prefer not to say"})]})]}),Object(l.jsx)("input",{value:w,onChange:e=>k(e.target.value),placeholder:"Interests (comma separated)",required:!0}),Object(l.jsx)("input",{value:J,onChange:e=>Y(e.target.value),placeholder:"Languages spoken (comma separated)",required:!0}),Object(l.jsxs)("select",{value:_,onChange:e=>P(e.target.value),children:[Object(l.jsx)("option",{value:"fox",children:"Fox"}),Object(l.jsx)("option",{value:"lotus",children:"Lotus"}),Object(l.jsx)("option",{value:"lion",children:"Lion"}),Object(l.jsx)("option",{value:"falcon",children:"Falcon"}),Object(l.jsx)("option",{value:"panda",children:"Panda"}),Object(l.jsx)("option",{value:"tiger",children:"Tiger"}),Object(l.jsx)("option",{value:"peacock",children:"Peacock"})]}),Object(l.jsx)("textarea",{value:Q,onChange:e=>X(e.target.value),rows:5,placeholder:"Private photo URLs (one per line)"}),j&&Object(l.jsx)("p",{className:"error-text",children:j}),Object(l.jsx)("button",{className:"btn btn-like",type:"submit",disabled:i,children:i?"Saving...":"Save Profile"})]})]})};const B=e=>{switch(e){case"man":return"man";case"woman":return"woman";case"non_binary":return"non_binary";case"other":return"other";default:return"prefer_not_say"}},K=e=>{switch(e){case"never":case"occasionally":case"socially":case"regularly":return e;default:return"prefer_not_say"}};var A=e=>{let{user:t,onComplete:a}=e;const[n,c]=Object(s.useState)(t.name||""),[r,i]=Object(s.useState)(t.age||21),[o,j]=Object(s.useState)(t.gender||"prefer_not_say"),[d,u]=Object(s.useState)(t.bio||""),[h,b]=Object(s.useState)(t.location||""),[p,m]=Object(s.useState)((t.interests||[]).join(", ")),[O,g]=Object(s.useState)(t.lookingFor||"prefer_not_say"),[x,y]=Object(s.useState)(t.relationshipGoal||"long_term"),[f,N]=Object(s.useState)(t.occupation||""),[S,w]=Object(s.useState)(t.education||""),[k,_]=Object(s.useState)(t.heightCm||170),[C,P]=Object(s.useState)(t.drinking||"prefer_not_say"),[E,L]=Object(s.useState)(t.smoking||"prefer_not_say"),[I,T]=Object(s.useState)(t.religion||""),[U,D]=Object(s.useState)((t.languages||[]).join(", ")),[R,q]=Object(s.useState)(t.avatarKey||"fox"),[A,F]=Object(s.useState)(""),[M,G]=Object(s.useState)(!1);return Object(l.jsx)("main",{className:"auth-layout",children:Object(l.jsxs)("section",{className:"auth-panel",children:[Object(l.jsx)("h1",{children:"Complete Your Profile"}),Object(l.jsx)("p",{children:"Fill all details to get better matches. Only your avatar is public until photo access is granted."}),Object(l.jsxs)("form",{className:"auth-form",onSubmit:async e=>{e.preventDefault(),F(""),G(!0);const t=p.split(",").map(e=>e.trim()).filter(Boolean),s=U.split(",").map(e=>e.trim()).filter(Boolean);if(t.length<3)return F("Please add at least 3 interests."),void G(!1);if(s.length<1)return F("Please add at least 1 language."),void G(!1);try{const e=await v({name:n,age:r,gender:B(o),bio:d,location:h,interests:t,avatarKey:R,lookingFor:O,relationshipGoal:x,occupation:f,education:S,heightCm:k,drinking:C,smoking:E,religion:I,languages:s,privatePhotos:[]});a(e)}catch(c){F(c instanceof Error?c.message:"Failed to save profile")}finally{G(!1)}},children:[Object(l.jsx)("input",{value:n,onChange:e=>c(e.target.value),placeholder:"Name",required:!0}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{type:"number",min:18,max:80,value:r,onChange:e=>i(Number(e.target.value)),placeholder:"Age",required:!0}),Object(l.jsxs)("select",{value:o,onChange:e=>j(e.target.value),children:[Object(l.jsx)("option",{value:"man",children:"Man"}),Object(l.jsx)("option",{value:"woman",children:"Woman"}),Object(l.jsx)("option",{value:"non_binary",children:"Non-binary"}),Object(l.jsx)("option",{value:"other",children:"Other"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Prefer not to say"})]})]}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsxs)("select",{value:O,onChange:e=>g((e=>{switch(e){case"man":case"woman":case"non_binary":case"everyone":return e;default:return"prefer_not_say"}})(e.target.value)),children:[Object(l.jsx)("option",{value:"man",children:"Looking for Men"}),Object(l.jsx)("option",{value:"woman",children:"Looking for Women"}),Object(l.jsx)("option",{value:"non_binary",children:"Looking for Non-binary"}),Object(l.jsx)("option",{value:"everyone",children:"Looking for Everyone"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Prefer not to say"})]}),Object(l.jsxs)("select",{value:x,onChange:e=>y((e=>{switch(e){case"short_term":case"marriage":case"friendship":return e;default:return"long_term"}})(e.target.value)),children:[Object(l.jsx)("option",{value:"long_term",children:"Long-term relationship"}),Object(l.jsx)("option",{value:"short_term",children:"Short-term dating"}),Object(l.jsx)("option",{value:"marriage",children:"Marriage"}),Object(l.jsx)("option",{value:"friendship",children:"Friendship first"})]})]}),Object(l.jsx)("input",{value:h,onChange:e=>b(e.target.value),placeholder:"Location",required:!0}),Object(l.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Bio",rows:3,required:!0}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{value:f,onChange:e=>N(e.target.value),placeholder:"Occupation",required:!0}),Object(l.jsx)("input",{value:S,onChange:e=>w(e.target.value),placeholder:"Education",required:!0})]}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsx)("input",{type:"number",min:120,max:230,value:k,onChange:e=>_(Number(e.target.value)),placeholder:"Height (cm)",required:!0}),Object(l.jsx)("input",{value:I,onChange:e=>T(e.target.value),placeholder:"Religion",required:!0})]}),Object(l.jsxs)("div",{className:"grid-two",children:[Object(l.jsxs)("select",{value:C,onChange:e=>P(K(e.target.value)),children:[Object(l.jsx)("option",{value:"never",children:"Drinking: Never"}),Object(l.jsx)("option",{value:"occasionally",children:"Drinking: Occasionally"}),Object(l.jsx)("option",{value:"socially",children:"Drinking: Socially"}),Object(l.jsx)("option",{value:"regularly",children:"Drinking: Regularly"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Drinking: Prefer not to say"})]}),Object(l.jsxs)("select",{value:E,onChange:e=>L(K(e.target.value)),children:[Object(l.jsx)("option",{value:"never",children:"Smoking: Never"}),Object(l.jsx)("option",{value:"occasionally",children:"Smoking: Occasionally"}),Object(l.jsx)("option",{value:"socially",children:"Smoking: Socially"}),Object(l.jsx)("option",{value:"regularly",children:"Smoking: Regularly"}),Object(l.jsx)("option",{value:"prefer_not_say",children:"Smoking: Prefer not to say"})]})]}),Object(l.jsx)("input",{value:p,onChange:e=>m(e.target.value),placeholder:"Interests (comma separated, minimum 3)",required:!0}),Object(l.jsx)("input",{value:U,onChange:e=>D(e.target.value),placeholder:"Languages spoken (comma separated)",required:!0}),Object(l.jsxs)("select",{value:R,onChange:e=>q(e.target.value),children:[Object(l.jsx)("option",{value:"fox",children:"Fox"}),Object(l.jsx)("option",{value:"lotus",children:"Lotus"}),Object(l.jsx)("option",{value:"lion",children:"Lion"}),Object(l.jsx)("option",{value:"falcon",children:"Falcon"}),Object(l.jsx)("option",{value:"panda",children:"Panda"}),Object(l.jsx)("option",{value:"tiger",children:"Tiger"}),Object(l.jsx)("option",{value:"peacock",children:"Peacock"})]}),A&&Object(l.jsx)("p",{className:"error-text",children:A}),Object(l.jsx)("button",{className:"btn btn-like",type:"submit",disabled:M,children:M?"Saving...":"Save and Continue"})]})]})})};var F=()=>{const e=Object(o.h)().userId||"",[t,a]=Object(s.useState)(null),[n,c]=Object(s.useState)(!0),[r,i]=Object(s.useState)("");return Object(s.useEffect)(()=>{e&&(async()=>{c(!0),i("");try{const t=await(async e=>(await O.get("/users/".concat(e))).data)(e);a(t)}catch(t){i(N(t,"Could not load profile"))}finally{c(!1)}})()},[e]),n?Object(l.jsx)("div",{className:"page-shell",children:Object(l.jsx)("p",{children:"Loading profile..."})}):r||!t?Object(l.jsx)("div",{className:"page-shell",children:Object(l.jsx)("p",{className:"error-text",children:r||"Profile unavailable"})}):Object(l.jsxs)("div",{className:"page-shell",children:[Object(l.jsx)("div",{className:"page-head",children:Object(l.jsxs)("h1",{children:[t.user.name,"'s Profile"]})}),Object(l.jsxs)("div",{className:"trust-panel",children:[Object(l.jsx)(C,{avatarKey:t.user.avatarKey,name:t.user.name,size:72}),Object(l.jsxs)("div",{children:[Object(l.jsx)("p",{className:"muted",children:t.user.location}),Object(l.jsx)("p",{className:"muted",children:t.user.gender.replace("_"," ")})]})]}),Object(l.jsxs)("div",{className:"profile-body",style:{marginTop:14},children:[Object(l.jsx)("p",{children:t.user.bio||"No bio yet."}),Object(l.jsx)("div",{className:"tag-row",children:(t.user.interests||[]).map(e=>Object(l.jsx)("span",{className:"tag",children:e},e))})]}),t.canViewPrivatePhotos?Object(l.jsx)("div",{className:"private-photo-grid",style:{marginTop:14},children:t.privatePhotos.map(e=>Object(l.jsx)("img",{src:e,alt:"Private profile",className:"private-photo"},e))}):Object(l.jsx)("p",{className:"muted",style:{marginTop:14},children:"Private photos are locked until both users build trust and grant access."})]})};a(57);var M=()=>{const[e,t]=Object(s.useState)(()=>localStorage.getItem("dating_token")||""),[a,n]=Object(s.useState)(null),[c,r]=Object(s.useState)(Boolean(e)),[j,u]=Object(s.useState)(""),[h,b]=Object(s.useState)(0);Object(s.useEffect)(()=>{(e=>{m=e})(e||"")},[e]),Object(s.useEffect)(()=>{(async()=>{if(u(""),!e)return n(null),void r(!1);try{let e=null;for(let s=0;s<3;s+=1)try{e=await g();break}catch(a){const e=S(a);if(401===e||403===e)return localStorage.removeItem("dating_token"),t(""),n(null),void u("");await new Promise(e=>setTimeout(e,700*(s+1)))}if(!e)return void u("Unable to load your session right now. Please retry.");n(e)}finally{r(!1)}})()},[e,h]);const p=Object(s.useMemo)(()=>Boolean(e&&a),[e,a]),O=Boolean(a&&!a.onboardingCompleted),v=e=>{e?localStorage.setItem("dating_token",e):localStorage.removeItem("dating_token"),t(e)},x=e=>{n(e)};return c?Object(l.jsx)("div",{className:"loading-shell",children:"Loading your profile..."}):j&&e?Object(l.jsx)("div",{className:"loading-shell",children:Object(l.jsxs)("div",{children:[Object(l.jsx)("p",{children:j}),Object(l.jsx)("button",{className:"btn btn-like",onClick:()=>{r(!0),b(e=>e+1)},children:"Retry"})]})}):Object(l.jsxs)(i.a,{children:[p&&!O&&Object(l.jsx)(d,{onLogout:()=>{v(""),n(null)}}),Object(l.jsxs)(o.d,{children:[Object(l.jsx)(o.b,{path:"/auth",children:p?Object(l.jsx)(o.a,{to:O?"/onboarding":"/discover"}):Object(l.jsx)(k,{onAuthenticated:(e,t)=>{v(e),n(t)}})}),Object(l.jsx)(o.b,{path:"/home",children:p?Object(l.jsx)(o.a,{to:O?"/onboarding":"/discover"}):Object(l.jsx)(T,{})}),Object(l.jsx)(o.b,{path:"/onboarding",children:p&&a?O?Object(l.jsx)(A,{user:a,onComplete:x}):Object(l.jsx)(o.a,{to:"/discover"}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/discover",children:p?O?Object(l.jsx)(o.a,{to:"/onboarding"}):Object(l.jsx)(I,{}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/matches",children:p?O?Object(l.jsx)(o.a,{to:"/onboarding"}):Object(l.jsx)(U,{}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/profile",exact:!0,children:p&&a?O?Object(l.jsx)(o.a,{to:"/onboarding"}):Object(l.jsx)(q,{onUserUpdated:x}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/profile/:userId",children:p?O?Object(l.jsx)(o.a,{to:"/onboarding"}):Object(l.jsx)(F,{}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/chat/:matchUserId",children:p&&a?O?Object(l.jsx)(o.a,{to:"/onboarding"}):Object(l.jsx)(P,{userId:a.id}):Object(l.jsx)(o.a,{to:"/auth"})}),Object(l.jsx)(o.b,{path:"/",children:Object(l.jsx)(o.a,{to:p?O?"/onboarding":"/discover":"/home"})})]})]})};r.a.render(Object(l.jsx)(n.a.StrictMode,{children:Object(l.jsx)(M,{})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.9542f0f4.chunk.js.map